<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino Agrela - Digital Portfolio</title>
    
    <!-- Tailwind CSS CDN for guaranteed styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; color: #1f2937; }
        .modal-open { overflow: hidden; }
        .main-content-transition { transition: opacity 300ms ease-out; }
        .modal-content::-webkit-scrollbar { width: 8px; }
        .modal-content::-webkit-scrollbar-thumb { background-color: #00779e; border-radius: 4px; }

        /* Existing video container (kept for compatibility) */
        .video-container { position: relative; width: 100%; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 0.5rem; }
        .video-container iframe, .video-container video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        .media-item { margin-top: 1.5rem; margin-bottom: 1.5rem; }

        /* Constrain media so the whole image/video fits without page scrolling */
        :root { --media-max-vh: 75vh; } /* Adjust to taste (e.g., 70vh or 65vh) */

        /* Images in case study: contain within viewport height */
        .cs-media-img {
          max-height: var(--media-max-vh);
          width: auto;
          max-width: 100%;
          height: auto;
          object-fit: contain;
          display: block;
          margin-left: auto;
          margin-right: auto;
          border-radius: 0.75rem; /* rounded-xl */
        }

        /* Videos in case study: maintain 16:9 but never exceed viewport height */
        .video-box {
          aspect-ratio: 16 / 9;
          width: min(100%, calc(var(--media-max-vh) * 16 / 9)); /* keeps height <= --media-max-vh */
          max-height: var(--media-max-vh);
          margin-left: auto;
          margin-right: auto;
          border-radius: 0.75rem;
          overflow: hidden;
        }
        .video-box iframe,
        .video-box video {
          width: 100%;
          height: 100%;
          border: 0;
          display: block;
          object-fit: contain;
          background: #000; /* avoids white bars around videos */
        }

        /* Brands scroller styles */
        #brand-track { gap: var(--brand-gap, 4rem); }
        .brand-dragging { cursor: grabbing !important; }
        .brand-draggable { cursor: grab; }

    </style>
</head>
<body class="antialiased">
    <!-- Case Study Modal -->
    <div id="case-study-modal" class="fixed inset-0 z-[100] bg-white overflow-y-scroll transition-transform duration-300 ease-in-out transform translate-x-full" style="display: none;"></div>

    <!-- Main Content Wrapper -->
    <div id="main-content-wrapper" class="main-content-transition">
        <!-- Header -->
        <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm shadow-sm">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="flex justify-between items-center py-4">
                    <div id="logo-link" class="text-xl sm:text-2xl font-extrabold tracking-tight cursor-pointer" onclick="scrollToSection('contact')">Dino Agrela</div>
                    <!-- Desktop nav -->
                    <nav class="hidden md:flex space-x-8 font-medium">
                        <a href="#work" onclick="handleNavClick(event, 'work')" class="nav-item text-sm sm:text-base">Work</a>
                        <a href="#brands" onclick="handleNavClick(event, 'brands')" class="nav-item text-sm sm:text-base">Brands</a>
                        <a href="#about" onclick="handleNavClick(event, 'about')" class="nav-item text-sm sm:text-base">About</a>
                        <a href="#contact" onclick="handleNavClick(event, 'contact')" class="nav-item text-sm sm:text-base">Contact</a>
                    </nav>
                    <!-- Mobile toggle -->
                    <button id="mobile-nav-toggle" class="md:hidden p-2 text-gray-700 rounded-lg hover:bg-gray-100 transition" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="mobile-menu">
                        <!-- hamburger -->
                        <svg id="icon-menu" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"/>
                        </svg>
                        <!-- close (hidden by default) -->
                        <svg id="icon-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <!-- Mobile menu panel -->
            <div id="mobile-menu" class="md:hidden hidden border-t border-gray-200 bg-white">
              <div class="container mx-auto px-6 max-w-7xl py-3 flex flex-col">
                <a href="#work" class="py-2 text-gray-800 hover:text-[#00779e]" data-mobile-link="work">Work</a>
                <a href="#brands" class="py-2 text-gray-800 hover:text-[#00779e]" data-mobile-link="brands">Brands</a>
                <a href="#about" class="py-2 text-gray-800 hover:text-[#00779e]" data-mobile-link="about">About</a>
                <a href="#contact" class="py-2 text-gray-800 hover:text-[#00779e]" data-mobile-link="contact">Contact</a>
              </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Hero Section -->
            <section id="hero" class="py-14 sm:py-16 md:py-24 bg-gray-50 container mx-auto px-6 max-w-7xl min-h-[calc(100vh-6rem)] flex items-center justify-center text-center">
                <div class="max-w-4xl">
                    <h1 class="text-4xl sm:text-6xl md:text-8xl font-black mb-5 sm:mb-6 leading-tight">
                        Designing <span class="text-[#47b1e0]">Intuitive</span> Digital Experiences.
                    </h1>
                    <p class="text-base sm:text-lg md:text-2xl text-gray-600 mb-8 sm:mb-10 font-light">
                        I've honed my skills through independent learning. I have a keen eye for detail and strive for excellence in everything I do.
                    </p>
                    <button onclick="scrollToSection('work')" class="inline-flex items-center justify-center px-6 sm:px-8 py-3 border border-transparent text-sm sm:text-base font-medium rounded-full shadow-xl text-white bg-[#47b1e0] hover:bg-[#00779e] transition">
                        View My Work
                    </button>
                </div>
            </section>

            <!-- Work Section -->
            <section id="work" class="py-12 sm:py-16 md:py-24 container mx-auto px-6 max-w-7xl">
                <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold mb-8 sm:mb-12 text-center">Selected Work</h2>
                <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8"></div>
                <div id="work-actions" class="text-center mt-8"></div>

<!-- Brands section -->
<section id="brands" class="py-8 sm:py-10 bg-white">
  <div class="container mx-auto px-6 max-w-7xl">
    <div class="flex items-center justify-between gap-4 mb-4 sm:mb-6">
      <h3 class="text-xl sm:text-2xl font-bold">Brands I’ve Worked With</h3>
    </div>

    <!-- Scroller viewport -->
    <div class="relative overflow-hidden">
      <!-- Fading edges for polish -->
      <div class="pointer-events-none absolute left-0 top-0 h-full w-10 sm:w-12 bg-gradient-to-r from-white to-transparent"></div>
      <div class="pointer-events-none absolute right-0 top-0 h-full w-10 sm:w-12 bg-gradient-to-l from-white to-transparent"></div>

      <!-- Track that scrolls (we’ll clone children to create an infinite loop) -->
      <div id="brand-track" class="flex items-center will-change-transform brand-draggable">
        <!-- One pass of logos -->
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270649/Showmax_ew8gkk.png" alt="Showmax" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270451/FNB_s07t8e.png" alt="FNB" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition"style="max-width: 160px; max-height: 80px; "/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270643/PEFMO_mtoucn.png" alt="PEFMO" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270950/Srvest_ufpgal.png" alt="Servest" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270996/Telkom_sqsfxb.png" alt="Telkom" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 140px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270445/First_Battery_pvldw5.png" alt="Battery Centre" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270973/SuperSport_sjvb8j.png" alt="SuperSport" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270429/Bottega_temywt.png" alt="Bottega" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270560/GG_vzjqti.png" alt="G&G Digital" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765271002/WSpot_fd1qaa.png" alt="W-Spot" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270654/Spazio_gvjkyy.png" alt="Spazio" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270636/Janssen_wbvgsx.png" alt="Janssen" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270566/Hollard_sdifxr.png" alt="Hollard" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 140px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270440/FBomb_trggpp.png" alt="F-Bomb" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270435/Exide_pllehb.png" alt="Exide" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>
        <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765270425/AMD_mjc06h.png" alt="AMD" class="h-8 sm:h-9 md:h-11 object-contain grayscale opacity-50 hover:grayscale-0 hover:opacity-100 transition" style="max-width: 160px; max-height: 80px;"/>

      </div>
    </div>
  </div>
</section>

            </section>

            <!-- About Section -->
            <section id="about" class="py-12 sm:py-16 md:py-24 container mx-auto px-6 max-w-7xl bg-gray-50 -mx-6 px-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-10 sm:gap-12 items-start">
                    <div class="lg:col-span-2">
                        <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold mb-6 sm:mb-8">Hello, I'm Dino Agrela</h2>
                        <p class="text-base sm:text-lg text-gray-700 mb-5 sm:mb-6 leading-relaxed">
                            I am a multidisciplinary designer with 10+ years of experience.<br>
                            I'm a technically and creatively minded designer dedicated to delivering high-quality work, thriving on the challenge of finding the perfect solution whether working independently or as part of a team. My calm and focused demeanor ensures I adapt quickly to new briefs, efficiently meeting tight deadlines without compromising quality. I am a perfectionist at heart and an adaptable, collaborative problem-solver.
                        </p>
                        <div class="mt-6 sm:mt-8">
                            <h3 class="text-xl sm:text-2xl font-bold mb-3 sm:mb-4">Core Skills</h3>
                            <div class="flex flex-wrap gap-2.5 sm:gap-3">
                                <span class="skill-tag text-sm sm:text-base">Full Adobe Suite</span>
                                <span class="skill-tag text-sm sm:text-base">Figma</span>
                                <span class="skill-tag text-sm sm:text-base">Wireframing</span>
                                <span class="skill-tag text-sm sm:text-base">Prototyping (Figma/XD)</span>
                                <span class="skill-tag text-sm sm:text-base">Design Systems</span>
                                <span class="skill-tag text-sm sm:text-base">Mobile & Web UI</span>
                                <span class="skill-tag text-sm sm:text-base">Mobile & Web UX</span>
                                <span class="skill-tag text-sm sm:text-base">Interaction Design</span>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1 flex justify-center lg:justify-end">
                        <div class="w-full max-w-sm bg-white p-6 rounded-xl shadow-2xl">
                            <img src="https://res.cloudinary.com/dzutg4biv/image/upload/v1765230895/portrait_nyxo5f.png" alt="Designer Portrait" class="w-full h-auto rounded-lg mb-4 object-cover" onerror="this.onerror=null; this.src='https://placehold.co/400x400/1f2937/f3f4f6?text=Designer+Portrait';" />
                            <p class="text-sm text-gray-500 italic">"Design is not just what it looks like and feels like. Design is how it works."</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Contact Section -->
            <section id="contact" class="py-12 sm:py-16 md:py-24 container mx-auto px-6 max-w-7xl">
                <div class="max-w-3xl mx-auto text-center">
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold mb-4">Let's Connect</h2>
                    <p class="text-base sm:text-xl text-gray-600 mb-8 sm:mb-10">
                        I'm open to new opportunities and collaborations.<br>
                        Whether you need a full-time lead designer or consultation on a challenging Design problem, drop me a line.
                    </p>
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4">
                        <!-- Email Button -->
                        <a href="mailto:DinoAgrela@gmail.com" class="inline-flex items-center justify-center px-6 sm:px-8 py-3 border border-transparent text-sm sm:text-base font-medium rounded-full shadow-xl text-white bg-[#47b1e0] hover:bg-[#00779e] transition">
                            <svg class="mr-3 h-6 w-6" stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 23 23" aria-hidden="true">
                                <path d="M4 9.00005L10.2 13.65C11.2667 14.45 12.7333 14.45 13.8 13.65L20 9"></path>
                                <path d="M3 9.17681C3 8.45047 3.39378 7.78123 4.02871 7.42849L11.0287 3.5396C11.6328 3.20402 12.3672 3.20402 12.9713 3.5396L19.9713 7.42849C20.6062 7.78123 21 8.45047 21 9.17681V17C21 18.1046 20.1046 19 19 19H5C3.89543 19 3 18.1046 3 17V9.17681Z"></path>
                            </svg>
                            DinoAgrela@gmail.com
                        </a>
                        
                        <!-- Phone Button -->
                        <a href="tel:+27825617992" class="inline-flex items-center justify-center px-6 sm:px-8 py-3 border border-transparent text-sm sm:text-base font-medium rounded-full shadow-xl text-white bg-[#47b1e0] hover:bg-[#00779e] transition">
                            <svg class="mr-3 h-6 w-6" stroke="currentColor" fill="none" stroke-width="9" viewBox="20 0 225 225" aria-hidden="true">
                                <path d="M176,220C98.80371,220,36,157.19629,36,80A52.06484,52.06484,0,0,1,81.4209,28.41211a12.01552,12.01552,0,0,1,12.47558,7.19141L113.9873,82.48047a11.97729,11.97729,0,0,1-.99023,11.2998L96.36133,119.19922a3.938,3.938,0,0,0-.291,3.86035h.001a80.54061,80.54061,0,0,0,37.19726,37.0293,3.93771,3.93771,0,0,0,3.8711-.31836l25.03515-16.69434a11.96393,11.96393,0,0,1,11.38379-1.0459l46.83789,20.07325a12.01851,12.01851,0,0,1,7.19141,12.4746A52.06486,52.06486,0,0,1,176,220ZM82.89941,36.31934a3.71329,3.71329,0,0,0-.47558.03027A44.04825,44.04825,0,0,0,44,80c0,72.78516,59.21484,132,132,132a44.04828,44.04828,0,0,0,43.65039-38.4248,3.98053,3.98053,0,0,0-2.40625-4.11817L170.4082,149.38379a3.99519,3.99519,0,0,0-3.7959.34863l-25.03515,16.69434A11.96472,11.96472,0,0,1,129.79,167.294a88.58663,88.58663,0,0,1-40.9082-40.72364l.001.001a11.96889,11.96889,0,0,1,.78516-11.75293l16.63574-25.41895a3.99531,3.99531,0,0,0,.33008-3.76855L86.543,38.75586A3.99936,3.99936,0,0,0,82.89941,36.31934Z"></path>
                            </svg>
                            +27 82 561 7992
                        </a>
                    </div>

                    <!-- Social icons -->
                    <div class="flex justify-center space-x-6 mt-10 sm:mt-12">
                        <!-- LinkedIn (clear icon) -->
                        <a href="https://www.linkedin.com/in/dinoagrela/" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="LinkedIn">
                            <svg class="w-6 h-6" viewBox="-20 0 300 300" aria-hidden="true" fill="currentColor">
                                <path d="M34.703,0.183C15.582,0.183,0.014,15.748,0,34.884C0,54.02,15.568,69.588,34.703,69.588 c19.128,0,34.688-15.568,34.688-34.704C69.391,15.75,53.83,0.183,34.703,0.183z"></path>
                                <path d="M60.748,83.531H8.654c-2.478,0-4.488,2.009-4.488,4.489v167.675c0,2.479,2.01,4.488,4.488,4.488h52.093 c2.479,0,4.489-2.01,4.489-4.488V88.02C65.237,85.539,63.227,83.531,60.748,83.531z"></path>
                                <path d="M193.924,81.557c-19.064,0-35.817,5.805-46.04,15.271V88.02c0-2.48-2.01-4.489-4.489-4.489H93.424 c-2.479,0-4.489,2.009-4.489,4.489v167.675c0,2.479,2.01,4.488,4.489,4.488h52.044c2.479,0,4.489-2.01,4.489-4.488v-82.957 c0-23.802,4.378-38.555,26.227-38.555c21.526,0.026,23.137,15.846,23.137,39.977v81.535c0,2.479,2.01,4.488,4.49,4.488h52.068 c2.478,0,4.488-2.01,4.488-4.488v-91.977C260.366,125.465,252.814,81.557,193.924,81.557z"></path>
                            </svg>
                        </a>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white">
            <div class="container mx-auto px-6 max-w-7xl py-12">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-lg sm:text-xl font-bold mb-4 md:mb-0 cursor-pointer" onclick="scrollToSection('hero')">Dino Agrela</div>
                    <div class="text-xs sm:text-sm text-gray-400">
                        &copy; <span id="current-year"></span> All rights reserved. | Designed for clarity and speed.
                    </div>
                    <div class="flex space-x-4 mt-4 md:mt-0">
                        <a href="#work" onclick="handleNavClick(event, 'work')" class="text-xs sm:text-sm text-gray-400 hover:text-[#47b1e0] transition">Work</a>
                        <a href="#brands" onclick="handleNavClick(event, 'brands')" class="text-xs sm:text-sm text-gray-400 hover:text-[#47b1e0] transition">Brands</a>
                        <a href="#about" onclick="handleNavClick(event, 'about')" class="text-xs sm:text-sm text-gray-400 hover:text-[#47b1e0] transition">About</a>
                        <a href="#contact" onclick="handleNavClick(event, 'contact')" class="text-xs sm:text-sm text-gray-400 hover:text-[#47b1e0] transition">Contact</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    
<script>
  // Perpetual horizontal scroll for brand logos (time-based + hover pause + drag)
  (function initBrandScroller() {
    const track = document.getElementById('brand-track');
    if (!track) return;

    // Clone children to create a seamless loop
    const originals = Array.from(track.children);
    const gapPx = 10; // must match the gap in your track
    originals.forEach(el => track.appendChild(el.cloneNode(true)));

    // Compute width of the first pass
    function measureFirstPassWidth() {
      const widths = originals.map(el => el.getBoundingClientRect().width);
      return widths.reduce((a, b) => a + b, 0) + (originals.length - 1) * gapPx;
    }

    let offset = 0;              // current translateX
    let isPaused = false;        // hover pause
    let firstPassWidth = measureFirstPassWidth();

    // Speed in px/sec (auto scroll)
    let speed = 12;
    window.setBrandScrollSpeed = function(newSpeedPps) {
      const ns = Number(newSpeedPps);
      if (!Number.isFinite(ns) || ns <= 0) return;
      speed = ns;
    };

    // Hover pause
    track.addEventListener('mouseenter', () => { isPaused = true; });
    track.addEventListener('mouseleave', () => { isPaused = false; });

    // Drag-to-scroll state
    let dragging = false;
    let lastClientX = 0;
    let velocity = 0;            // for a subtle fling
    let lastTsForVelocity = performance.now();

    // Helpers to clamp/loop offset
    function normalizeOffset(x) {
      // Loop when exceeding first pass to keep it seamless
      if (Math.abs(x) >= firstPassWidth) {
        const sign = x < 0 ? -1 : 1;
        x = sign * (Math.abs(x) % firstPassWidth);
      }
      return x;
    }

    // Pointer events (mouse + touch unified)
    function onDragStart(clientX) {
      dragging = true;
      isPaused = true; // pause auto scroll while dragging
      lastClientX = clientX;
      track.classList.add('brand-dragging');
      track.style.transition = 'none'; // remove any transition while dragging
      velocity = 0;
      lastTsForVelocity = performance.now();
    }
    function onDragMove(clientX) {
      if (!dragging) return;
      const dx = clientX - lastClientX;
      lastClientX = clientX;

      // Move opposite to pointer for natural feel (drag left => scroll left)
      offset += dx;
      offset = normalizeOffset(offset);
      track.style.transform = `translateX(${offset}px)`;

      // Track velocity
      const now = performance.now();
      const dt = (now - lastTsForVelocity) / 1000;
      lastTsForVelocity = now;
      if (dt > 0) velocity = dx / dt; // px/sec
    }
    function onDragEnd() {
      if (!dragging) return;
      dragging = false;
      track.classList.remove('brand-dragging');
      // Apply a small fling and then resume auto-scroll
      const flingDuration = 300; // ms
      const start = performance.now();
      const initialVelocity = Math.max(Math.min(velocity, 500), -2500); // clamp
      function fling(ts) {
        const t = ts - start;
        const progress = Math.min(t / flingDuration, 1);
        const ease = 1 - Math.pow(1 - progress, 2); // ease-out
        const delta = initialVelocity * (1 - ease) * (flingDuration / 820) * 0.06; // damped
        offset += delta;
        offset = normalizeOffset(offset);
        track.style.transform = `translateX(${offset}px)`;
        if (progress < 1) requestAnimationFrame(fling);
        else isPaused = false; // resume auto scroll
      }
      requestAnimationFrame(fling);
    }

    // Mouse events
    track.addEventListener('mousedown', (e) => {
      e.preventDefault();
      onDragStart(e.clientX);
    });
    window.addEventListener('mousemove', (e) => onDragMove(e.clientX));
    window.addEventListener('mouseup', () => onDragEnd());

    // Touch events
    track.addEventListener('touchstart', (e) => {
      if (e.touches && e.touches.length) {
        onDragStart(e.touches[0].clientX);
      }
    }, { passive: true });
    window.addEventListener('touchmove', (e) => {
      if (e.touches && e.touches.length) {
        onDragMove(e.touches[0].clientX);
      }
    }, { passive: true });
    window.addEventListener('touchend', () => onDragEnd());

    // Time-based auto loop (disabled while dragging or paused)
    let lastTs = performance.now();
    function loop(ts) {
      const dt = (ts - lastTs) / 1000;
      lastTs = ts;

      if (!isPaused && !dragging) {
        offset -= speed * dt;
        if (Math.abs(offset) >= firstPassWidth) offset = 0;
        track.style.transform = `translateX(${offset}px)`;
      }
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    // Re-measure on resize
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        firstPassWidth = measureFirstPassWidth();
        offset = 0;
      }, 150);
    });
  })();
</script>

<script>
        // History-aware modal navigation baseline
        (function initHistoryBaseline() {
            try {
                const baseUrl = location.pathname + location.search;
                history.replaceState({ page: 'index' }, '', baseUrl);
            } catch (e) { /* noop */ }
        })();

        // Mobile nav toggle
        function initMobileNav() {
            const toggleBtn = document.getElementById('mobile-nav-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            const iconMenu = document.getElementById('icon-menu');
            const iconClose = document.getElementById('icon-close');
            const header = document.querySelector('header');

            if (!toggleBtn || !mobileMenu) return;

            const mql = window.matchMedia('(min-width: 768px)');

            function setTopOffset() {
                // keep menu anchored just below header height
                if (header) mobileMenu.style.top = header.offsetHeight + 'px';
            }

            function setOpen(open) {
                mobileMenu.classList.toggle('hidden', !open);
                toggleBtn.setAttribute('aria-expanded', String(open));
                if (iconMenu && iconClose) {
                    iconMenu.classList.toggle('hidden', open);
                    iconClose.classList.toggle('hidden', !open);
                }
                if (open) setTopOffset();
            }

            function isOpen() {
                return !mobileMenu.classList.contains('hidden');
            }

            toggleBtn.addEventListener('click', () => {
                setOpen(!isOpen());
            });

            // Close when clicking a mobile link
            mobileMenu.querySelectorAll('a[data-mobile-link]').forEach(a => {
                a.addEventListener('click', (e) => {
                    const section = a.getAttribute('data-mobile-link');
                    setOpen(false);
                    if (section) {
                        e.preventDefault();
                        handleNavClick(e, section);
                    }
                });
            });

            // Close on outside click
            document.addEventListener('click', (e) => {
                if (!isOpen()) return;
                const t = e.target;
                if (t === toggleBtn || toggleBtn.contains(t)) return;
                if (t === mobileMenu || mobileMenu.contains(t)) return;
                setOpen(false);
            });

            // Close on ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && isOpen()) setOpen(false);
            });

            // Close when moving to md and up
            function handleMql(e) { if (e.matches) setOpen(false); }
            if (typeof mql.addEventListener === 'function') mql.addEventListener('change', handleMql);
            else if (typeof mql.addListener === 'function') mql.addListener(handleMql);

            // Adjust top on resize (debounced)
            let rTimer;
            window.addEventListener('resize', () => {
                clearTimeout(rTimer);
                rTimer = setTimeout(setTopOffset, 100);
            });
        }

        async function ensureAllProjectsLoaded() {
            if (typeof ALL_PROJECTS !== 'undefined') return true;
            const candidates = ['/projects.json', '/designer-portfolio/projects.json', '/src/data/projects.json'];
            for (const c of candidates) {
                try {
                    const resp = await fetch(c, { cache: 'no-store' });
                    if (!resp.ok) continue;
                    const data = await resp.json();
                    window.ALL_PROJECTS = data;
                    return true;
                } catch (err) { console.warn('Failed to load', c, err); continue; }
            }
            return false;
        }

        let visibleCount = 0;
        let cardToScrollTo = null;
        let isModalAnimating = false;

        function getInitialLimit() { const w = window.innerWidth; return (w >= 768 && w < 1024) ? 4 : 3; }
        function scrollToSection(id) { const el = document.getElementById(id); if (el) el.scrollIntoView({ behavior: 'smooth' }); }
        function handleNavClick(event, id) { event.preventDefault(); scrollToSection(id); }

        function renderProjectCard(project) {
            const card = document.createElement('div');
            card.id = `project-card-${project.id}`;
            card.className = "relative overflow-hidden rounded-xl shadow-lg hover:shadow-2xl transition-all duration-500 ease-in-out cursor-pointer group";
            card.onclick = () => openCaseStudy(project.id);

            // Robust accent handling (supports hex or Tailwind class)
            const accent = project.accentColor || 'bg-[#47b1e0]';
            const isHexOnly = typeof accent === 'string' && accent.trim().startsWith('#');
            const badgeClass = isHexOnly ? '' : accent;
            const badgeStyleAttr = isHexOnly ? `style="background-color: ${accent};"` : '';
            
            card.innerHTML = `
                <img src="${project.heroImage}" alt="${project.title} hero" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 group-hover:opacity-80" onerror="this.onerror=null; this.src='https://placehold.co/800x600/6366f1/ffffff?text=Project+Mockup';" />
                <div class="absolute inset-0 flex flex-col justify-end p-6 bg-gradient-to-t from-black/80 to-transparent transition-opacity duration-300">
                    <div class="transform translate-y-2 group-hover:translate-y-0 transition-transform duration-300">
                        <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full text-white mb-2 ${badgeClass}" ${badgeStyleAttr}>${project.category}</span>
                        <h3 class="text-xl sm:text-2xl font-bold text-white mb-1 leading-snug">${project.title}</h3>
                        <p class="text-gray-300 text-sm">${project.year}</p>
                    </div>
                </div>
            `;
            return card;
        }

        function renderWorkSection() {
            const grid = document.getElementById('projects-grid');
            const actions = document.getElementById('work-actions');
            grid.innerHTML = ''; actions.innerHTML = '';

            const visibleProjects = ALL_PROJECTS.filter(p => !p.isHidden);
            const totalProjects = visibleProjects.length;
            const currentLimit = getInitialLimit();
            if (visibleCount === 0 || visibleCount > totalProjects || visibleCount < currentLimit) visibleCount = currentLimit;

            visibleProjects.slice(0, visibleCount).forEach(project => grid.appendChild(renderProjectCard(project)));

            const remainingCount = totalProjects - visibleCount;
            const isExpanded = visibleCount === totalProjects;
            const initialLimit = getInitialLimit();

            if (remainingCount > 0 && !isExpanded) {
                actions.innerHTML += `
                    <button onclick="handleShowMore()" class="inline-flex items-center justify-center px-6 py-3 border border-[#47b1e0] text-sm sm:text-base font-medium rounded-full text-[#47b1e0] hover:bg-[#ebfdff] transition">
                        Show All ${totalProjects} Projects
                    </button>`;
            } else if (isExpanded && totalProjects > initialLimit) {
                actions.innerHTML += `
                    <button onclick="handleCollapse()" class="inline-flex items-center justify-center px-6 py-3 bg-[#47b1e0] border border-[#47b1e0] text-sm sm:text-base font-medium rounded-full text-white hover:bg-[#00779e] transition">
                        Show Less
                    </button>`;
            }
        }
        function handleShowMore() { visibleCount = ALL_PROJECTS.filter(p => !p.isHidden).length; renderWorkSection(); }
        function handleCollapse() { visibleCount = getInitialLimit(); renderWorkSection(); scrollToSection('work'); }

        // Media rendering constrained to viewport height
        function generateMediaHTML(item) {
            const url = item.url.trim(); if (!url) return '';
            if (item.isVideo) {
                let embedUrl = url;
                if (url.includes('youtube.com/watch?v=')) embedUrl = url.replace('watch?v=', 'embed/');
                else if (url.includes('youtu.be/')) embedUrl = url.replace('youtu.be/', 'youtube.com/embed/');
                else if (url.includes('vimeo.com/')) embedUrl = url.replace('vimeo.com/', 'player.vimeo.com/video/');
                if (embedUrl.includes('embed') || embedUrl.includes('player.vimeo.com')) {
                    return `<div class="video-box shadow-2xl transition duration-500 hover:scale-[1.005]">
                        <iframe src="${embedUrl}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                    </div>`;
                }
                return `<div class="video-box shadow-2xl transition duration-500 hover:scale-[1.005]">
                    <video controls muted playsinline class="w-full h-full object-contain">
                        <source src="${url}" type="video/mp4">Your browser does not support the video tag.
                    </video>
                </div>`;
            } else {
                return `<img src="${url}" alt="Case Study Media" class="cs-media-img shadow-2xl transition duration-500 hover:scale-[1.005]" onerror="this.onerror=null; this.src='https://placehold.co/1200x600/111827/d1d5db?text=Design+Mockup+Placeholder';" />`;
            }
        }

        // Helper: strip numeric prefix like "01. Title"
        function titleWithoutIndex(t) {
            return (t || '').replace(/^\s*\d+\.\s*/, '');
        }

        function getCaseStudyHTML(projectId) {
            const project = ALL_PROJECTS.find(p => p.id === projectId);
            if (!project || !project.caseStudy) return '<div>Project not found or incomplete data.</div>';
            const { title, category, year, caseStudy } = project;

            // Sections: <p> shows "Section 01/02/..." and <h2> shows the actual title (without numeric prefix)
            const sectionsHTML = (caseStudy.sections || []).map((section, i) => {
                const sectionNum = String(i + 1).padStart(2, '0');
                const displayTitle = titleWithoutIndex(section.title || '') || `Section ${sectionNum}`;
                let mediaHTML = '';
                if (section.mediaItems && section.mediaItems.length > 0) {
                    mediaHTML = section.mediaItems.map(item => `<div class="media-item">${generateMediaHTML(item)}</div>`).join('');
                }
                return `
                    <div id="${section.id}" class="group pt-2">
                        <p class="text-sm font-semibold text-[#47b1e0] mb-2">Section ${sectionNum}</p>
                        <h2 class="text-2xl sm:text-3xl md:text-4xl font-extrabold mb-6 text-gray-900">${displayTitle}</h2>
                        <p class="text-base sm:text-lg text-gray-700 leading-relaxed mb-8">${section.content || ''}</p>
                        ${mediaHTML}
                    </div>`;
            }).join('');

            const navLinksHTML = (caseStudy.sections || []).map((section, i) => {
                const label = titleWithoutIndex(section.title || `Section ${String(i + 1).padStart(2, '0')}`);
                return `
                <a href="#${section.id}" onclick="event.preventDefault(); document.getElementById('${section.id}').scrollIntoView({ behavior: 'smooth' });" class="text-sm sm:text-base text-gray-600 hover:text-[#47b1e0] transition">
                    ${label}
                </a>`;
            }).join('');

            const details = [];
            if (caseStudy.client) details.push(`<span>Client: ${caseStudy.client}</span>`);
            if (caseStudy.role) details.push(`<span>Role: ${caseStudy.role}</span>`);
            if (caseStudy.duration) details.push(`<span>Duration: ${caseStudy.duration}</span>`);
            const detailsHTML = details.join('');

            return `
                <div class="container mx-auto px-6 max-w-7xl modal-content">
                    <div class="sticky top-0 z-10 bg-white/95 backdrop-blur-sm py-4 border-b border-gray-200 flex justify-between items-center">
                        <button onclick="goBackFromCaseStudy()" class="flex items-center text-[#47b1e0] hover:text-[#00779e] transition duration-300 font-semibold text-sm sm:text-base">
                            <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                            Back to Work Index
                        </button>
                        <nav class="hidden sm:flex space-x-4 text-sm">${navLinksHTML}</nav>
                    </div>
                    <div class="pt-10 sm:pt-12 pb-20 sm:pb-24 max-w-5xl mx-auto">
                        <header class="text-center mb-12 sm:mb-16">
                            <span class="text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider">${category} - ${year}</span>
                            <h1 id="modal-title" class="text-3xl sm:text-5xl md:text-7xl font-black mt-3 mb-5 sm:mb-6 leading-tight text-gray-900">${title}</h1>
                            <p class="text-base sm:text-xl text-gray-600 italic max-w-3xl mx-auto">${caseStudy.brief || ''}</p>
                            ${detailsHTML ? `<div class="mt-6 sm:mt-8 flex justify-center space-x-6 text-gray-600 text-sm">${detailsHTML}</div>` : ''}
                        </header>
                        <div class="space-y-16 sm:space-y-20">${sectionsHTML}</div>
                        <div class="mt-16 sm:mt-20 pt-8 sm:pt-10 border-t border-gray-300 text-center">
                            <p class="text-xl sm:text-2xl font-bold text-gray-800 mb-4 sm:mb-6">Ready to discuss your next project?</p>
                            <button onclick="goBackFromCaseStudy()" class="inline-flex items-center justify-center px-6 sm:px-8 py-3 bg-[#47b1e0] border border-[#47b1e0] text-sm sm:text-base font-medium rounded-full text-white hover:bg-[#00779e] transition">
                                Back to Index
                            </button>
                        </div>
                    </div>
                </div>`;
        }

        // UI-only close (used by popstate)
        function closeCaseStudyUI() {
            if (isModalAnimating) return; isModalAnimating = true;
            const modal = document.getElementById('case-study-modal');
            const mainContent = document.getElementById('main-content-wrapper');
            modal.classList.add('translate-x-full');
            setTimeout(() => {
                document.body.classList.remove('modal-open');
                mainContent.classList.remove('opacity-50', 'pointer-events-none');
                modal.style.display = 'none';
                const cardElement = cardToScrollTo ? document.getElementById(`project-card-${cardToScrollTo}`) : null;
                if (cardElement) cardElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                cardToScrollTo = null; isModalAnimating = false;
            }, 300);
        }

        // Button handler: behave like native back
        function goBackFromCaseStudy() {
            try { history.back(); }
            catch { closeCaseStudyUI(); }
        }

        function openCaseStudy(projectId) {
            if (isModalAnimating) return; isModalAnimating = true;

            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobile-menu');
            const iconMenu = document.getElementById('icon-menu');
            const iconClose = document.getElementById('icon-close');
            const toggleBtn = document.getElementById('mobile-nav-toggle');
            if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
                if (toggleBtn) toggleBtn.setAttribute('aria-expanded', 'false');
                if (iconMenu && iconClose) { iconMenu.classList.remove('hidden'); iconClose.classList.add('hidden'); }
            }

            // Push a modal state so hardware back closes the modal
            try {
                history.pushState({ page: 'case', projectId }, '', `#${projectId}`);
            } catch {}

            window.scrollPosition = window.scrollY;
            cardToScrollTo = projectId;

            const modal = document.getElementById('case-study-modal');
            const mainContent = document.getElementById('main-content-wrapper');
            modal.innerHTML = getCaseStudyHTML(projectId);
            modal.style.display = 'block';
            document.body.classList.add('modal-open');
            mainContent.classList.add('opacity-50', 'pointer-events-none');
            setTimeout(() => { modal.classList.remove('translate-x-full'); isModalAnimating = false; }, 10);
        }

        // Back button handling: close modal instead of leaving the site
        window.addEventListener('popstate', () => {
            const modal = document.getElementById('case-study-modal');
            const isOpen = modal && modal.style.display !== 'none';
            if (isOpen) closeCaseStudyUI();
        });

        window.onload = async function() {
            initMobileNav();

            const loaded = await ensureAllProjectsLoaded();
            if (!loaded || typeof ALL_PROJECTS === 'undefined') {
                console.error("CRITICAL ERROR: projects data not loaded. Check that projects.json exists.");
                document.getElementById('projects-grid').innerHTML = '<div class="col-span-3 text-center p-8 text-red-600 border border-red-300 rounded-lg">ERROR: Projects failed to load. Please ensure a projects JSON file is present at <code>/projects.json</code>. You can generate this from the admin editor.</div>';
                return;
            }
            document.getElementById('current-year').textContent = new Date().getFullYear();
            renderWorkSection();
            document.querySelectorAll('.skill-tag').forEach(el => {
                el.className = "px-4 py-2 bg-white text-gray-800 border border-gray-200 rounded-full text-sm font-medium shadow-sm";
            });
            document.querySelectorAll('.social-link').forEach(el => {
                el.className = "text-gray-500 hover:text-[#47b1e0] transition duration-300 p-3 rounded-full hover:bg-[#ebfdff] inline-block";
            });
            document.addEventListener('keydown', (event) => {
                // ESC closes modal without affecting history; mobile init also listens for ESC to close menu
                if (event.key === 'Escape' && document.getElementById('case-study-modal').style.display !== 'none') closeCaseStudyUI();
            });
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    const totalVisible = ALL_PROJECTS.filter(p => !p.isHidden).length;
                    if (visibleCount !== totalVisible) renderWorkSection();
                }, 150);
            });
        };
    </script>
</body>
</html>